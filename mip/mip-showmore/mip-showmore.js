(window.MIP=window.MIP||[]).push({name:"mip-showmore",func:function(){define("mip-showmore/mip-showmore",["require","customElement","util","viewport"],function(t){var i=t("customElement").create(),e=t("util"),o=t("viewport"),s=function(t){if(this.ele=t,this.clickBtn=t.querySelector("[showmorebtn]"),this.showBox=this.ele.querySelector("[showmorebox]"),this.animateTime=this.ele.getAttribute("animatetime")||0,!this.showBox)this.showBox=this.ele};return s.prototype.init=function(){if(!isNaN(this.animateTime)){if(this.maxHeight=this.ele.getAttribute("maxheight"),this.maxLen=this.ele.getAttribute("maxlen"),this.bottomShadow="1"===this.ele.getAttribute("bottomshadow"),this.bottomShadowClassName="linear-gradient",this.maxHeight&&isNaN(this.maxHeight)){var t,i,s=this.maxHeight.split(":");if(s.length>1){switch(t=s[0].trim(),i=s[1].trim(),t){case"screen":this.showType="HEIGHTSCREEN",this.maxHeight=o.getHeight()*i;break;case"heightpx":this.showType="HEIGHT"}this._initHeight()}}else if(this.maxHeight&&!isNaN(this.maxHeight))this.showType="HEIGHT",this._initHeight();else if(this.maxLen&&!isNaN(this.maxLen))this.showType="LENGTH",this._maxLenFn();else this.maxHeight=0,this._initHeight();this._bindClick(),e.css(this.ele,{visibility:"visible"})}},s.prototype._initHeight=function(){if(this.showBoxHei=e.rect.getElementOffset(this.showBox).height,this.showBoxHei>this.maxHeight){e.css(this.showBox,{height:this.maxHeight+"px",overflow:"hidden"});var t=this.ele.querySelector(".mip-showmore-btnshow");e.css(t,{display:"block"}),this.bottomShadow&&this.showBox.classList.toggle(this.bottomShadowClassName)}},s.prototype._maxLenFn=function(){if(this.originalHtml=this.showBox.innerHTML,this.cutOffText=this._cutHtmlStr(this.maxLen),this.originalHtml.length!==this.cutOffText.length){var t=this.ele.querySelector(".mip-showmore-btnshow");e.css(t,{display:"block"}),this.bottomShadow&&this.showBox.classList.toggle(this.bottomShadowClassName),this.cutOffText="<p class='mip-showmore-abstract'>"+this.cutOffText+"...</p>",this.showBox.innerHTML=this.cutOffText}},s.prototype._bindClick=function(){if(this.clickBtn){var t=this;this.clickBtn.addEventListener("click",function(i){t.toggle.apply(t)})}},s.prototype.toggle=function(t){var i=this.ele.classList,o=t?t.target:null,s={};if(s.aniTime=this.animateTime||.3,"LENGTH"===this.showType)if(s.oriHeight=getComputedStyle(this.showBox).height,i.contains("mip-showmore-boxshow"))this.showBox.innerHTML=this.cutOffText,s.tarHeight=getComputedStyle(this.showBox).height,this.showBox.innerHTML=this.originalHtml,s.type="fold",s.cbFun=function(t){t.showBox.innerHTML=t.cutOffText,t._toggleClickBtn(o,"showOpen"),i.remove("mip-showmore-boxshow")}.bind(void 0,this);else i.add("mip-showmore-boxshow"),this.showBox.innerHTML=this.originalHtml,s.type="unfold",s.cbFun=function(t){t._toggleClickBtn(o,"showClose")}.bind(void 0,this);else if("HEIGHT"===this.showType||"HEIGHTSCREEN"===this.showType)if(i.contains("mip-showmore-boxshow"))i.remove("mip-showmore-boxshow"),s.type="fold",s.tarHeight=this.maxHeight+"px",s.cbFun=function(t,i){t._toggleClickBtn(i,"showOpen")}.bind(void 0,this,o);else i.add("mip-showmore-boxshow"),s.type="unfold",s.cbFun=function(t,i){t._toggleClickBtn(i,"showClose")}.bind(void 0,this,o);e.fn.heightAni({ele:this.showBox,type:s.type,transitionTime:s.aniTime,tarHeight:s.tarHeight,oriHeight:s.oriHeight,cbFun:s.cbFun})},s.prototype._toggleClickBtn=function(t,i){if(i)if("showOpen"===i){if(t)t.innerText=t.dataset.opentext;this._changeBtnText({display:"block"},{display:"none"})}else{if(t){var e=t.innerText;t.innerText=t.dataset.closetext||"收起",t.dataset.opentext=e}this._changeBtnText({display:"none"},{display:"block"})}},s.prototype._cutHtmlStr=function(t){for(var i=this.showBox.childNodes,e="",o=0,s=[],h=0;h<i.length;h++){var n=i[h].textContent.replace(/(^\s*)|(\s*$)/g,"");if(e.length+n.length<=t)e+=n,o=e.length,s.push(i[h]);else{var r=t-o>0?t-o:o-t,a=n?n.slice(0,r):"";i[h].textContent=a,s.push(i[h]);break}}for(var m="",l=0;l<s.length;l++){var c=s[l].nodeType;if(1===c)m+=s[l].outerHTML;else if(3===c)m+=s[l].textContent}return m},s.prototype._changeBtnText=function(t,i){var e=this.ele.querySelector(".mip-showmore-btnshow"),o=this.ele.querySelector(".mip-showmore-btnhide");this._changeBtnShow(e,t),this._changeBtnShow(o,i)},s.prototype._changeBtnShow=function(t,i){e.css(t,i)},i.prototype.build=function(){var t=this.element,i=new s(t);i.init(),this.addEventAction("toggle",function(t){i.toggle(t)})},i}),define("mip-showmore",["mip-showmore/mip-showmore"],function(t){return t}),function(){function t(t,i){t.registerMipElement("mip-showmore",i,'mip-showmore{visibility:hidden;overflow:hidden}mip-showmore .mip-showmore-originalhtml,mip-showmore .mip-showmore-btnhide,mip-showmore .mip-showmore-btnshow{display:none}mip-showmore.linear-gradient:after{content:"";position:absolute;bottom:0;display:block;width:100%;height:90px;background:-moz-linear-gradient(to bottom, rgba(255,255,255,0), #fff);background:-webkit-linear-gradient(to bottom, rgba(255,255,255,0), #fff);background:linear-gradient(to bottom, rgba(255,255,255,0), #fff)}mip-showmore [showmorebox]{overflow:hidden}.mip-showmore-btn{border:1px solid #ddd;background:#fafafa;display:inline-block;padding:15px}.mip-showmore-btn:hover,.mip-showmore-btn:active{background:#f0f0f0}')}if(window.MIP)require(["mip-showmore"],function(i){t(window.MIP,i)});else require(["mip","mip-showmore"],t)}()}});