(window.MIP=window.MIP||[]).push({name:"mip-showmore",func:function(){define("mip-showmore/mip-showmore",["require","customElement","util","viewport"],function(t){function i(t){var i,e=t.ele,o=t.type,s=n||[];if(o&&e){if(void 0===t.transitionTime||isNaN(t.transitionTime))i=.24;else i=Math.min(parseFloat(t.transitionTime),1);var h,a=void 0!==t.oriHeight?t.oriHeight:getComputedStyle(e).height,r=t.cbFun||function(){};if("unfold"===o){if(void 0!==t.tarHeight)h=t.tarHeight;else e.style.transition="height 0s",e.style.height="auto",h=getComputedStyle(e).height;var l=setTimeout(function(){e.style.transition="height 0s",e.style.height="auto"},1e3*i);s[0]=l}else if("fold"===o)h=t.tarHeight||0;e.style.height=a;var m=setTimeout(function(){e.style.transition="height "+i+"s",e.style.height=h},10),d=setTimeout(function(){r()},1e3*i);s[e.id]=s[e.id]||[],s[e.id][1]=m,s[e.id][2]=d}}function e(t){var i=document.createElement("div"),e=getComputedStyle(t);i.innerHTML=t.innerHTML,i.style.padding=e.padding,i.style.margin=e.margin,i.style.border=e.border,i.style.position="absolute",t.parentNode.insertBefore(i,t),i.style.height="auto",i.style.visibility="hidden";var o=s.rect.getElementOffset(i).height;return t.parentNode.removeChild(i),o}var o=t("customElement").create(),s=t("util"),h=t("viewport"),n=[],a=function(t){if(this.ele=t,this.clickBtn=t.querySelector("[showmorebtn]"),this.clickBtnSpan=this.clickBtn&&this.clickBtn.querySelector(".mip-showmore-btnshow"),this.showBox=this.ele.querySelector("[showmorebox]"),this.animateTime=this.ele.getAttribute("animatetime"),null===this.animateTime||isNaN(this.animateTime))this.animateTime=.24;if(this.heightType=["HEIGHTSCREEN","HEIGHT","LENGTH"],this.btn=document.querySelector('div[on="tap:'+this.ele.id+'.toggle"]'),this.eleid=t.id,!this.showBox)this.showBox=this.ele};return a.prototype.init=function(){if(!isNaN(this.animateTime)){if(this.maxHeight=this.ele.getAttribute("maxheight"),this.maxLen=this.ele.getAttribute("maxlen"),this.bottomShadow="1"===this.ele.getAttribute("bottomshadow"),this.bottomShadowClassName="linear-gradient",this.maxHeight&&isNaN(this.maxHeight)){var t,i,e=this.maxHeight.split(":");if(e.length>1)switch(t=e[0].trim(),i=e[1].trim(),t){case"screen":this.showType=this.heightType[0],this.maxHeight=h.getHeight()*i,this._initHeight();break;case"heightpx":this.showType=this.heightType[1],this._initHeight()}}else if(this.maxHeight&&!isNaN(this.maxHeight))this.showType=this.heightType[1],this._initHeight();else if(this.maxLen&&!isNaN(this.maxLen))this.showType=this.heightType[2],this._initTextLength();else this.maxHeight=0,this._initHeight();this._bindClick(),s.css(this.ele,{visibility:"visible"});var o=this.clickBtnSpan&&getComputedStyle(this.clickBtnSpan).display,n=this.btn&&getComputedStyle(this.btn).display;this.btnDisplay=n||o}},a.prototype.changeBtnStyle=function(t){var i=this.ele.querySelector(".mip-showmore-btnshow"),e=this.btn||i;if("fold"===t)s.css(e,"display","inline-block"),this.bottomShadow&&this.showBox.classList.add(this.bottomShadowClassName);else if("unfold"===t)s.css(e,"display","none"),this.bottomShadow&&this.showBox.classList.remove(this.bottomShadowClassName)},a.prototype._initHeight=function(){var t;if(this.ele.style.height&&this.ele.style.height.match("px"))t=e(this.ele);else t=s.rect.getElementOffset(this.ele).height;if(t>this.maxHeight)s.css(this.showBox,{height:this.maxHeight+"px",overflow:"hidden"}),this.changeBtnStyle("fold");else s.css(this.showBox,t,"auto"),this.changeBtnStyle("unfold")},a.prototype._initTextLength=function(){if(!this.oriDiv){var t=this.showBox.innerHTML,i=this._cutHtmlStr(this.maxLen);if(t.length!==i.length)this.changeBtnStyle("fold"),this.showBox.innerHTML="",this.oriDiv=document.createElement("div"),this.oriDiv.setAttribute("class","mip-showmore-originText mip-showmore-nodisplay"),this.oriDiv.innerHTML=t,this.showBox.appendChild(this.oriDiv),this.cutDiv=document.createElement("div"),this.cutDiv.setAttribute("class","mip-showmore-abstract"),this.cutDiv.innerHTML="<p>"+i+"...</p>",this.showBox.appendChild(this.cutDiv)}},a.prototype._bindClick=function(){if(this.clickBtn){var t=this;this.clickBtn.addEventListener("click",function(i){t.toggle.apply(t)})}},a.prototype.addClassWhenUnfold=function(){var t=this.btn;t&&t.classList.add("mip-showmore-btn-hide")},a.prototype.toggle=function(t){var o=this.ele.classList,h=t?t.target:null,n={};if(n.aniTime=this.animateTime,this.showType===this.heightType[2]){n.oriHeight=s.rect.getElementOffset(this.showBox).height+"px";var a=this.oriDiv,r=this.cutDiv;if(o.contains("mip-showmore-boxshow"))a.classList.add("mip-showmore-nodisplay"),r.classList.remove("mip-showmore-nodisplay"),n.tarHeight=s.rect.getElementOffset(this.showBox).height+"px",a.classList.remove("mip-showmore-nodisplay"),r.classList.add("mip-showmore-nodisplay"),this.bottomShadow&&this.showBox.classList.add(this.bottomShadowClassName),n.type="fold",n.cbFun=function(t){t._toggleClickBtn(h,"showOpen"),o.remove("mip-showmore-boxshow"),a.classList.add("mip-showmore-nodisplay"),r.classList.remove("mip-showmore-nodisplay")}.bind(void 0,this);else this.addClassWhenUnfold(),this.bottomShadow&&this.showBox.classList.remove(this.bottomShadowClassName),n.type="unfold",a.classList.remove("mip-showmore-nodisplay"),r.classList.add("mip-showmore-nodisplay"),n.tarHeight=e(this.showBox)+"px",this.showBox.style.height=this.maxHeight+"px",n.cbFun=function(t){t._toggleClickBtn(h,"showClose"),o.add("mip-showmore-boxshow")}.bind(void 0,this)}else if(this.showType===this.heightType[1]||this.showType===this.heightType[0])if(o.contains("mip-showmore-boxshow"))this.bottomShadow&&this.showBox.classList.add(this.bottomShadowClassName),o.remove("mip-showmore-boxshow"),n.type="fold",n.tarHeight=this.maxHeight+"px",n.cbFun=function(t,i){t._toggleClickBtn(i,"showOpen")}.bind(void 0,this,h);else this.addClassWhenUnfold(),this.bottomShadow&&this.showBox.classList.remove(this.bottomShadowClassName),o.add("mip-showmore-boxshow"),n.type="unfold",n.cbFun=function(t,i){t._toggleClickBtn(i,"showClose"),t.ele.style.height="auto"}.bind(void 0,this,h);i({ele:this.showBox,type:n.type,transitionTime:n.aniTime,tarHeight:n.tarHeight,oriHeight:n.oriHeight,cbFun:n.cbFun})},a.prototype._toggleClickBtn=function(t,i){if(i)if("showOpen"===i){if(t)t.innerText=t.dataset.opentext;this._changeBtnText({display:this.btnDisplay},{display:"none"})}else{if(t){var e=t.innerText;t.innerText=t.dataset.closetext||"收起",t.dataset.opentext=e}this._changeBtnText({display:"none"},{display:this.btnDisplay})}},a.prototype._cutHtmlStr=function(t){for(var i=this.showBox.childNodes,e="",o=0,s=[],h=0;h<i.length;h++){var n=i[h].textContent.replace(/(^\s*)|(\s*$)/g,"");if(e.length+n.length<=t)e+=n,o=e.length,s.push(i[h]);else{var a=t-o>0?t-o:o-t,r=n?n.slice(0,a):"";i[h].textContent=r,s.push(i[h]);break}}for(var l="",m=0;m<s.length;m++){var d=s[m].nodeType;if(1===d)l+=s[m].outerHTML;else if(3===d)l+=s[m].textContent}return l},a.prototype._changeBtnText=function(t,i){var e=this.ele.querySelector(".mip-showmore-btnshow"),o=this.ele.querySelector(".mip-showmore-btnhide");this._changeBtnShow(e,t),this._changeBtnShow(o,i)},a.prototype._changeBtnShow=function(t,i){s.css(t,i)},o.prototype.build=function(){var t=this.element,i=new a(t);i.init(),this.addEventAction("toggle",function(t){i.toggle(t)}),window.addEventListener("resize",function(){i.init()},!1)},o.prototype.detachedCallback=function(){for(var t=n&&n[this.element.id]||[],i=0;i<t.length;i++)window.clearTimeout(t[i])},o}),define("mip-showmore",["mip-showmore/mip-showmore"],function(t){return t}),function(){function t(t,i){t.registerMipElement("mip-showmore",i,'mip-showmore{visibility:hidden;overflow:hidden;transform:translateZ(0)}mip-showmore .mip-showmore-originalhtml,mip-showmore .mip-showmore-btnhide,mip-showmore .mip-showmore-btnshow{display:none}mip-showmore.linear-gradient:after{content:"";position:absolute;bottom:0;display:block;width:100%;height:90px;background:-moz-linear-gradient(to bottom, rgba(255,255,255,0), #fff);background:-webkit-linear-gradient(to bottom, rgba(255,255,255,0), #fff);background:linear-gradient(to bottom, rgba(255,255,255,0), #fff)}mip-showmore [showmorebox]{overflow:hidden}.mip-showmore-btn{display:none;padding:15px;border:1px solid #ddd;background:#fafafa}.mip-showmore-btn:hover,.mip-showmore-btn:active{background:#f0f0f0}.mip-showmore-nodisplay{display:none}')}if(window.MIP)require(["mip-showmore"],function(i){t(window.MIP,i)});else require(["mip","mip-showmore"],t)}()}});