define("mip-semi-fixed/mip-semi-fixed",["require","util","viewport","customElement","fixed-element","viewer"],function(e){function i(e){var i=this.element,t=this.container,n=this.threshold,o=this.fixedClassNames;if(s.rect.getElementOffset(i).top<=n){if(t.className.indexOf(o)<0)t.className+=o;t.setAttribute(d.STATUS_FIXED,""),s.css(t,"top",n+"px")}else t.className=t.className.replace(o,""),t.removeAttribute(d.STATUS_FIXED),s.css(t,"top","")}function t(e){var i=this.element;if(s.rect.getElementOffset(i).top<=this.threshold)s.css(this.fixedContainer.parentNode,{display:"block"}),s.css(this.fixedContainer,{opacity:1}),s.css(this.container,{opacity:0});else s.css(this.fixedContainer.parentNode,{display:"none"}),s.css(this.fixedContainer,{opacity:0}),s.css(this.container,{opacity:1})}var s=e("util"),n=e("viewport"),o=e("customElement").create(),r=e("fixed-element"),a=e("viewer"),d={STATUS_FIXED:"mip-semi-fixed-fixedStatus",STATUS_SCROLL:"mip-semi-fixed-scrollStatus"};return o.prototype.build=function(){var e=this,o=e.element;if(!r||!r._fixedLayer||o.parentNode!==r._fixedLayer){if(e.container=o.querySelector("div[mip-semi-fixed-container]"),!e.container)return void console.error("必须有 <div mip-semi-fixed-container> 子节点");if(e.threshold=o.getAttribute("threshold")||0,e.fixedClassNames=" "+o.getAttribute("fixedClassNames"),e.container.setAttribute(d.STATUS_SCROLL,""),a.isIframed&&s.platform.isIos()){try{var f=r._fixedLayer.querySelector("#"+o.id);e.fixedContainer=f.querySelector("div[mip-semi-fixed-container]"),e.fixedContainer.className+=e.fixedClassNames,e.fixedContainer.setAttribute(d.STATUS_FIXED,""),e.fixedContainer.removeAttribute(d.STATUS_SCROLL),s.css(e.fixedContainer,{top:e.threshold+"px",opacity:0})}catch(e){console.error(e)}n.on("scroll",function(){t.call(e,n)}),document.body.addEventListener("touchmove",function(i){t.call(e,n)})}else n.on("scroll",function(){i.call(e,n)}),document.body.addEventListener("touchmove",function(t){i.call(e,n)});if(!s.platform.isIos()&&o.offsetTop<=e.threshold){if(e.container.className.indexOf(e.fixedClassNames)<0)e.container.className+=e.fixedClassNames;e.container.setAttribute(d.STATUS_FIXED,""),s.css(e.container,"top",e.threshold+"px")}else if(s.platform.isIos()&&a.isIframed&&o.offsetTop-n.getScrollTop()<=e.threshold)s.css(this.fixedContainer.parentNode,{display:"block"}),s.css(this.fixedContainer,{opacity:1}),s.css(this.container,{opacity:0});e.addEventAction("close",function(i){if(i.preventDefault(),s.css(o,{display:"none"}),a.isIframed)s.css(e.fixedContainer,{display:"none"})})}},o}),define("mip-semi-fixed",["mip-semi-fixed/mip-semi-fixed"],function(e){return e}),function(){function e(e,i){e.registerMipElement("mip-semi-fixed",i,"mip-semi-fixed{position:relative;width:100%}.mip-fixedlayer div[mip-semi-fixed-scrollStatus],mip-semi-fixed div[mip-semi-fixed-scrollStatus]{position:absolute;z-index:1;width:100%;-webkit-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0)}.mip-fixedlayer mip-semi-fixed{position:fixed !important;width:100%}.mip-fixedlayer div[mip-semi-fixed-fixedStatus],mip-semi-fixed div[mip-semi-fixed-fixedStatus]{position:fixed;width:100%;z-index:999}")}if(window.MIP)require(["mip-semi-fixed"],function(i){e(window.MIP,i)});else require(["mip","mip-semi-fixed"],e)}();